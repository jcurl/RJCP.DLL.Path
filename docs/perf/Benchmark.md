# Benchmark Results

These are the results of running the tool `PathBenchmark` between .NET 4.8 and
.NET Core 3.1.

## Overview and Measurements

The tests are run with the following machine. Results are specific to the OS,
.NET versions, and possibly the phase of the moon. They should be used for
relative comparisons only.

(results are generated by the `runperf.py` script in the root of the repository)

### Test Runner - Windows

```text
Results = Benchmark.Net48

BenchmarkDotNet=v0.13.1 OS=Windows 10.0.19043.1288 (21H1/May2021Update)
Intel Core i7-6700T CPU 2.80GHz (Skylake), 1 CPU(s), 8 logical and 4 physical core(s)
  [HOST] : .NET Framework 4.8 (4.8.4420.0), X64 RyuJIT
```

```text
Results = Benchmark.NetCore31

BenchmarkDotNet=v0.13.1 OS=Windows 10.0.19043.1288 (21H1/May2021Update)
Intel Core i7-6700T CPU 2.80GHz (Skylake), 1 CPU(s), 8 logical and 4 physical core(s)
  [HOST] : .NET Core 3.1.20 (CoreCLR 4.700.21.47003, CoreFX 4.700.21.47101), X64 RyuJIT
```

| Type                            | Method          | mean (Net48) | stderr | mean (NetCore31) | stderr |
|:--------------------------------|:----------------|-------------:|-------:|-----------------:|-------:|
| UnixPathAppendBenchmark         | RootPath        | 125.24       | 0.43   | 89.17            | 0.35   |
| UnixPathAppendBenchmark         | RelativePath    | 125.44       | 0.41   | 93.22            | 0.30   |
| UnixPathInstantiateBenchmark    | FixedDrive      | 84.22        | 0.25   | 70.72            | 0.29   |
| UnixPathInstantiateBenchmark    | RelativePath    | 155.47       | 0.07   | 141.12           | 0.55   |
| UnixPathParentBenchmark         | Parent          | 17.71        | 0.08   | 16.25            | 0.07   |
| UnixPathParentBenchmark         | ParentRoot      | 5.72         | 0.03   | 6.37             | 0.04   |
| UnixPathParentBenchmark         | RelativeParent  | 40.78        | 0.18   | 38.57            | 0.10   |
| UnixPathRelativeBenchmark       | PinnedRelative  | 80.70        | 0.23   | 77.18            | 0.25   |
| UnixPathTrimBenchmark           | Trimmed         | 60.50        | 0.23   | 57.07            | 0.21   |
| UnixPathTrimBenchmark           | NoTrim          | 4.64         | 0.03   | 4.06             | 0.03   |
| WindowsPathAppendBenchmark      | DosDrive        | 135.87       | 0.28   | 104.01           | 0.36   |
| WindowsPathAppendBenchmark      | DosDriveAbs     | 7.00         | 0.02   | 7.20             | 0.04   |
| WindowsPathAppendBenchmark      | UncShare        | 132.24       | 0.47   | 98.24            | 0.29   |
| WindowsPathAppendBenchmark      | RelativePath    | 137.91       | 0.43   | 103.67           | 0.43   |
| WindowsPathInstantiateBenchmark | DosDrive        | 76.31        | 0.04   | 71.47            | 0.28   |
| WindowsPathInstantiateBenchmark | UncShare        | 228.26       | 0.74   | 224.01           | 0.80   |
| WindowsPathInstantiateBenchmark | UncSharePartial | 126.51       | 0.26   | 115.83           | 0.44   |
| WindowsPathInstantiateBenchmark | RelativePath    | 153.30       | 0.59   | 151.04           | 0.57   |
| WindowsPathParentBenchmark      | DosParent       | 19.42        | 0.03   | 16.89            | 0.09   |
| WindowsPathParentBenchmark      | UncParent       | 16.35        | 0.06   | 16.51            | 0.09   |
| WindowsPathParentBenchmark      | DosParentRoot   | 6.46         | 0.03   | 5.65             | 0.03   |
| WindowsPathParentBenchmark      | UncParentRoot   | 0.85         | 0.01   | 0.95             | 0.02   |
| WindowsPathParentBenchmark      | RelativeParent  | 41.99        | 0.17   | 39.25            | 0.17   |
| WindowsPathRelativeBenchmark    | DosRelative     | 89.89        | 0.20   | 81.96            | 0.20   |
| WindowsPathTrimBenchmark        | Trimmed         | 59.76        | 0.23   | 57.83            | 0.23   |
| WindowsPathTrimBenchmark        | NoTrim          | 5.07         | 0.01   | 4.55             | 0.03   |

While the software is identical, the compilation and execution is generally 20-30% faster on .NET Core.

### Test Runner - Linux

Running on the same machine in an Ubuntu 20.04 Virtual Machine:

```text
Results = Benchmark.Net48

BenchmarkDotNet=v0.13.1 OS=ubuntu 20.04
Intel Core i7-6700T CPU 2.80GHz (Skylake), 1 CPU(s), 2 logical and 2 physical core(s)
  [HOST] : Mono 6.12.0.122 (tarball Mon), X64
```

```text
Results = Benchmark.NetCore31

BenchmarkDotNet=v0.13.1 OS=ubuntu 20.04
Intel Core i7-6700T CPU 2.80GHz (Skylake), 1 CPU(s), 2 logical and 2 physical core(s)
  [HOST] : .NET Core 3.1.21 (CoreCLR 4.700.21.51404, CoreFX 4.700.21.51508), X64 RyuJIT
```

| Type                            | Method          | mean (Net48) | stderr | mean (NetCore31) | stderr |
|:--------------------------------|:----------------|-------------:|-------:|-----------------:|-------:|
| UnixPathAppendBenchmark         | RootPath        | 274.02       | 0.18   | 126.11           | 0.18   |
| UnixPathAppendBenchmark         | RelativePath    | 275.09       | 0.14   | 126.61           | 0.08   |
| UnixPathInstantiateBenchmark    | FixedDrive      | 175.73       | 0.54   | 91.55            | 0.10   |
| UnixPathInstantiateBenchmark    | RelativePath    | 347.09       | 0.25   | 177.97           | 0.18   |
| UnixPathParentBenchmark         | Parent          | 35.30        | 0.06   | 23.15            | 0.08   |
| UnixPathParentBenchmark         | ParentRoot      | 13.18        | 0.02   | 6.77             | 0.00   |
| UnixPathParentBenchmark         | RelativeParent  | 73.97        | 0.20   | 51.42            | 0.10   |
| UnixPathRelativeBenchmark       | PinnedRelative  | 147.97       | 0.52   | 88.67            | 0.25   |
| UnixPathTrimBenchmark           | Trimmed         | 97.56        | 0.28   | 70.33            | 0.05   |
| UnixPathTrimBenchmark           | NoTrim          | 9.84         | 0.05   | 4.10             | 0.01   |
| WindowsPathAppendBenchmark      | DosDrive        | 289.21       | 0.96   | 133.08           | 0.38   |
| WindowsPathAppendBenchmark      | DosDriveAbs     | 10.18        | 0.03   | 7.93             | 0.01   |
| WindowsPathAppendBenchmark      | UncShare        | 279.78       | 0.34   | 133.97           | 0.10   |
| WindowsPathAppendBenchmark      | RelativePath    | 283.56       | 0.44   | 132.33           | 0.09   |
| WindowsPathInstantiateBenchmark | DosDrive        | 172.48       | 0.72   | 90.41            | 0.16   |
| WindowsPathInstantiateBenchmark | UncShare        | 489.17       | 0.56   | 271.93           | 0.25   |
| WindowsPathInstantiateBenchmark | UncSharePartial | 254.25       | 0.17   | 142.48           | 0.09   |
| WindowsPathInstantiateBenchmark | RelativePath    | 347.83       | 0.17   | 182.89           | 0.13   |
| WindowsPathParentBenchmark      | DosParent       | 37.45        | 0.11   | 24.32            | 0.07   |
| WindowsPathParentBenchmark      | UncParent       | 31.12        | 0.02   | 20.86            | 0.04   |
| WindowsPathParentBenchmark      | DosParentRoot   | 13.58        | 0.03   | 6.88             | 0.01   |
| WindowsPathParentBenchmark      | UncParentRoot   | 3.70         | 0.03   | 1.05             | 0.00   |
| WindowsPathParentBenchmark      | RelativeParent  | 76.88        | 0.21   | 51.62            | 0.07   |
| WindowsPathRelativeBenchmark    | DosRelative     | 207.12       | 0.14   | 98.91            | 0.15   |
| WindowsPathTrimBenchmark        | Trimmed         | 97.82        | 0.41   | 73.42            | 0.05   |
| WindowsPathTrimBenchmark        | NoTrim          | 10.08        | 0.01   | 5.02             | 0.01   |

The below results can't be compared with above, that they're a different
machine type, but running Ubuntu and Mono.

```text
Results = Benchmark.Net48

BenchmarkDotNet=v0.13.1 OS=ubuntu 20.04
Intel Core i7-4930K CPU 3.40GHz (Haswell), 1 CPU(s), 12 logical and 6 physical core(s)
  [HOST] : Mono 6.12.0.122 (tarball Mon), X64
```

```text
Results = Benchmark.NetCore31

BenchmarkDotNet=v0.13.1 OS=ubuntu 20.04
Intel Core i7-4930K CPU 3.40GHz (Haswell), 1 CPU(s), 12 logical and 6 physical core(s)
  [HOST] : .NET Core 3.1.21 (CoreCLR 4.700.21.51404, CoreFX 4.700.21.51508), X64 RyuJIT
```

| Type                            | Method          | mean (Net48) | stderr | mean (NetCore31) | stderr |
|:--------------------------------|:----------------|-------------:|-------:|-----------------:|-------:|
| UnixPathAppendBenchmark         | RootPath        | 299.18       | 0.08   | 136.38           | 0.04   |
| UnixPathAppendBenchmark         | RelativePath    | 307.34       | 0.07   | 137.01           | 0.05   |
| UnixPathInstantiateBenchmark    | FixedDrive      | 183.92       | 0.57   | 97.37            | 0.04   |
| UnixPathInstantiateBenchmark    | RelativePath    | 392.16       | 0.10   | 192.57           | 0.08   |
| UnixPathParentBenchmark         | Parent          | 34.74        | 0.01   | 24.01            | 0.01   |
| UnixPathParentBenchmark         | ParentRoot      | 15.01        | 0.01   | 8.05             | 0.01   |
| UnixPathParentBenchmark         | RelativeParent  | 77.56        | 0.01   | 54.42            | 0.01   |
| UnixPathRelativeBenchmark       | PinnedRelative  | 153.59       | 0.04   | 94.98            | 0.03   |
| UnixPathTrimBenchmark           | Trimmed         | 100.65       | 0.01   | 72.24            | 0.03   |
| UnixPathTrimBenchmark           | NoTrim          | 11.74        | 0.01   | 5.18             | 0.00   |
| WindowsPathAppendBenchmark      | DosDrive        | 338.08       | 0.05   | 145.88           | 0.05   |
| WindowsPathAppendBenchmark      | DosDriveAbs     | 13.50        | 0.00   | 8.47             | 0.00   |
| WindowsPathAppendBenchmark      | UncShare        | 313.53       | 0.08   | 145.54           | 0.04   |
| WindowsPathAppendBenchmark      | RelativePath    | 333.07       | 0.09   | 148.19           | 0.09   |
| WindowsPathInstantiateBenchmark | DosDrive        | 190.97       | 0.04   | 93.33            | 0.04   |
| WindowsPathInstantiateBenchmark | UncShare        | 540.09       | 0.10   | 285.36           | 0.03   |
| WindowsPathInstantiateBenchmark | UncSharePartial | 271.49       | 0.16   | 154.58           | 0.03   |
| WindowsPathInstantiateBenchmark | RelativePath    | 369.54       | 0.22   | 193.77           | 0.04   |
| WindowsPathParentBenchmark      | DosParent       | 35.99        | 0.01   | 24.48            | 0.01   |
| WindowsPathParentBenchmark      | UncParent       | 30.70        | 0.01   | 22.52            | 0.06   |
| WindowsPathParentBenchmark      | DosParentRoot   | 15.00        | 0.01   | 8.12             | 0.00   |
| WindowsPathParentBenchmark      | UncParentRoot   | 3.86         | 0.00   | 1.05             | 0.00   |
| WindowsPathParentBenchmark      | RelativeParent  | 78.76        | 0.02   | 54.18            | 0.02   |
| WindowsPathRelativeBenchmark    | DosRelative     | 198.31       | 0.03   | 102.34           | 0.04   |
| WindowsPathTrimBenchmark        | Trimmed         | 100.89       | 0.03   | 74.68            | 0.04   |
| WindowsPathTrimBenchmark        | NoTrim          | 11.42        | 0.00   | 5.21             | 0.00   |

But they do show that Mono is at a significant disadvantage over .NET Core.
